getwd()
rm(list = ls())
rates <- read.table('sites.dat', head=T, sep=',', stringsAsFactors=F)
rsa <- read.table('1HPV_dimer.rsa', head=T, stringsAsFactors=F)$RSA
distances <- read.table('distances.dat', head=F, sep=',', stringsAsFactors=T)
map <- read.table('aas.fasta.map', head=T, stringsAsFactors=F)
rm(list = ls())
rates <- read.table('sites.dat', head=T, sep=',', stringsAsFactors=F)
rsa <- read.table('1HPV_dimer.rsa', head=T, stringsAsFactors=F)$RSA
distances <- read.table('distances.dat', head=F, sep=',', stringsAsFactors=T)
map <- read.table('aas.fasta.map', head=F, stringsAsFactors=F)
map
dN.dS <- rates$dN.dS[map$V3]
source('~/Google Drive/Documents/PostDoc/HIVStructuralDeterminants/hiv_structural_determinants-paper-now/data/protease/protease_structure/predictors/calc_correlations.R')
source('~/Google Drive/Documents/PostDoc/HIVStructuralDeterminants/hiv_structural_determinants-paper-now/data/protease/protease_structure/predictors/calc_correlations.R')
source('~/Google Drive/Documents/PostDoc/HIVStructuralDeterminants/hiv_structural_determinants-paper-now/data/protease/protease_structure/predictors/calc_correlations.R')
source('~/Google Drive/Documents/PostDoc/HIVStructuralDeterminants/hiv_structural_determinants-paper-now/data/protease/protease_structure/predictors/calc_correlations.R')
source('~/Google Drive/Documents/PostDoc/HIVStructuralDeterminants/hiv_structural_determinants-paper-now/data/protease/protease_structure/predictors/calc_correlations.R')
best.r
source('~/Google Drive/Documents/PostDoc/HIVStructuralDeterminants/hiv_structural_determinants-paper-now/data/protease/protease_structure/predictors/calc_correlations.R')
free.distances <- distances[best & -small.set, ]
best <- which(fit.correlations^2 == max(fit.correlations^2))
small.set <- sample(1:length(dN.dS), length(dN.dS)*0.9)
fit.dN.dS <- dN.dS[small.set]
fit.distances <- distances[small.set, ]
fit.correlations <- as.vector(sapply(free.distances, function(x) cor(fit.dN.dS,
predict(lm(fit.dN.dS ~ x)))))
source('~/Google Drive/Documents/PostDoc/HIVStructuralDeterminants/hiv_structural_determinants-paper-now/data/protease/protease_structure/predictors/calc_correlations.R')
best
free.dN.dS <- dN.dS[-small.set]
free.distances <- distances[best & -small.set, ]
free.dN.dS
free.distances
small.set <- sample(1:length(dN.dS), length(dN.dS)*0.9)
fit.dN.dS <- dN.dS[small.set]
fit.distances <- distances[, small.set]
fit.correlations <- as.vector(sapply(1:ncol(fit.distances), function(x) cor(fit.dN.dS,
predict(lm(fit.dN.dS ~ fit.distances[, x])))))
distances[, 1:2]
length(fit.dN.dS)
small.set <- sample(1:length(dN.dS), length(dN.dS)*0.9)
fit.dN.dS <- dN.dS[small.set]
fit.distances <- distances[small.set, ]
fit.correlations <- as.vector(sapply(1:ncol(fit.distances), function(x) cor(fit.dN.dS,
predict(lm(fit.dN.dS ~ fit.distances[, x])))))
best <- which(fit.correlations^2 == max(fit.correlations^2))
free.dN.dS <- dN.dS[-small.set]
free.distances <- distances[-small.set, ]
free.correlations <- cor(free.dN.dS,
predict(lm(free.dN.dS ~ free.distances)))
source('~/Google Drive/Documents/PostDoc/HIVStructuralDeterminants/hiv_structural_determinants-paper-now/data/protease/protease_structure/predictors/calc_correlations.R')
rfree
source('~/Google Drive/Documents/PostDoc/HIVStructuralDeterminants/hiv_structural_determinants-paper-now/data/protease/protease_structure/predictors/calc_correlations.R')
free
rfree
r
best.r
source('~/Google Drive/Documents/PostDoc/HIVStructuralDeterminants/hiv_structural_determinants-paper-now/data/protease/protease_structure/predictors/calc_correlations.R')
source('~/Google Drive/Documents/PostDoc/HIVStructuralDeterminants/hiv_structural_determinants-paper-now/data/protease/protease_structure/predictors/calc_correlations.R')
source('~/Google Drive/Documents/PostDoc/HIVStructuralDeterminants/hiv_structural_determinants-paper-now/data/protease/protease_structure/predictors/calc_correlations.R')
source('~/Google Drive/Documents/PostDoc/HIVStructuralDeterminants/hiv_structural_determinants-paper-now/data/protease/protease_structure/predictors/calc_correlations.R')
source('~/Google Drive/Documents/PostDoc/HIVStructuralDeterminants/hiv_structural_determinants-paper-now/data/protease/protease_structure/predictors/calc_correlations.R')
source('~/Google Drive/Documents/PostDoc/HIVStructuralDeterminants/hiv_structural_determinants-paper-now/data/protease/protease_structure/predictors/calc_correlations.R')
source('~/Google Drive/Documents/PostDoc/HIVStructuralDeterminants/hiv_structural_determinants-paper-now/data/protease/protease_structure/predictors/calc_correlations.R')
ls
vi best.site
best.site
table(best.site)
rsa
length(rsa)
source('~/Google Drive/Documents/PostDoc/HIVStructuralDeterminants/hiv_structural_determinants-paper-now/data/protease/protease_structure/predictors/calc_correlations.R')
source('~/Google Drive/Documents/PostDoc/HIVStructuralDeterminants/hiv_structural_determinants-paper-now/data/protease/protease_structure/predictors/calc_correlations.R')
table(best.site)
a<-table(best.site)
a$
4
max(a)
mode(best.site)
a<-sort(table(best.site))
a
a<-names(-sort(table(best.site)))[1]
a
a<-names(sort(table(best.site)))[1]
a
a<-names(sort(-table(best.site)))[1]
a
source('~/Google Drive/Documents/PostDoc/HIVStructuralDeterminants/hiv_structural_determinants-paper-now/data/protease/protease_structure/predictors/calc_correlations.R')
source('~/Google Drive/Documents/PostDoc/HIVStructuralDeterminants/hiv_structural_determinants-paper-now/data/protease/protease_structure/predictors/calc_correlations.R')
source('~/Google Drive/Documents/PostDoc/HIVStructuralDeterminants/hiv_structural_determinants-paper-now/data/protease/protease_structure/predictors/calc_correlations.R')
distances
correlations
correlations <- as.vector(sapply(1:ncol(distances), function(x) cor(dN.dS,
predict(lm(dN.dS ~ distances[, x])))))
write.table(data.frame(correlations), file= 'distance_model.correlations', row.names=F, col.names=F)
getwd()
rm(list = ls())
map <- read.table('aas.fasta.map', sep=',', head=F, stringsAsFactors=F)
rsa <- read.table('1HPV_dimer.rsa', head=T, stringsAsFactors=F)$RSA
rsa <- rsa[map$V3!='-']
distances <- read.table('distances.dat', head=F, sep=',', stringsAsFactors=T)
distances <- distances[map$V3!='-', map$V3!='-']
rates <- read.table('sites.dat', head=T, sep=',', stringsAsFactors=F)
keep.alignment.sites <- map$V3[map$V3 != '-']
dN.dS <- rates$dN.dS[as.numeric(keep.alignment.sites)]
source('~/Google Drive/Documents/PostDoc/HIVStructuralDeterminants/hiv_structural_determinants/data/protease/protease_structure/predictors/calc_correlations.R')
fit <- lm(dN.dS ~ rsa)
summary(fit)
source('~/Google Drive/Documents/PostDoc/HIVStructuralDeterminants/hiv_structural_determinants/data/protease/protease_structure/predictors/calc_correlations.R')
fit <- lm(dN.dS ~ rsa)
summary(fit)
source('~/Google Drive/Documents/PostDoc/HIVStructuralDeterminants/hiv_structural_determinants/data/protease/protease_structure/predictors/calc_correlations.R')
source('~/Google Drive/Documents/PostDoc/HIVStructuralDeterminants/hiv_structural_determinants/data/protease/protease_structure/predictors/calc_correlations.R')
source('~/Google Drive/Documents/PostDoc/HIVStructuralDeterminants/hiv_structural_determinants/data/protease/protease_structure/predictors/calc_correlations.R')
source('~/Google Drive/Documents/PostDoc/HIVStructuralDeterminants/hiv_structural_determinants/data/protease/protease_structure/predictors/calc_correlations.R')
source('~/Google Drive/Documents/PostDoc/HIVStructuralDeterminants/hiv_structural_determinants/data/protease/protease_structure/predictors/calc_correlations.R')
source('~/Google Drive/Documents/PostDoc/HIVStructuralDeterminants/hiv_structural_determinants/data/protease/protease_structure/predictors/calc_correlations.R')
source('~/Google Drive/Documents/PostDoc/HIVStructuralDeterminants/hiv_structural_determinants/data/protease/protease_structure/predictors/calc_correlations.R')
source('~/Google Drive/Documents/PostDoc/HIVStructuralDeterminants/hiv_structural_determinants/data/protease/protease_structure/predictors/calc_correlations.R')
source('~/Google Drive/Documents/PostDoc/HIVStructuralDeterminants/hiv_structural_determinants/data/protease/protease_structure/predictors/calc_correlations.R')
source('~/Google Drive/Documents/PostDoc/HIVStructuralDeterminants/hiv_structural_determinants/data/protease/protease_structure/predictors/calc_correlations.R')
print(mean(rfree))
print(mean(best.r))
print(summary(fit.rsa)$r.squared)
source('~/Google Drive/Documents/PostDoc/HIVStructuralDeterminants/hiv_structural_determinants/data/protease/protease_structure/predictors/calc_correlations.R')
plot(1:10, 1:10^2)
plot(1:10, (1:10)^2)
plot(1:10, 1/(1:10)^2)
plot(1:10, (1:10)^2)
plot(1:10, 1/(1:10)^2)
plot(1:10, (1:10))
plot(1:10, 1/(1:10))
plot(1:10, (1:10)^3)
plot(1:10, 1/(1:10)^3)
plot(1:10, (-10:10)^2)
plot(-10:10, (-10:10)^2)
plot(-10:10, 1/(-10:10)^2)
plot(-10:10, (-10:10)^2)
plot(-10:10, 1/(-10:10)^2)
source('~/Google Drive/Documents/PostDoc/HIVStructuralDeterminants/hiv_structural_determinants/data/protease/protease_structure/predictors/calc_correlations.R')
source('~/Google Drive/Documents/PostDoc/HIVStructuralDeterminants/hiv_structural_determinants/data/protease/protease_structure/predictors/calc_correlations.R')
plot(dN.dS)
plot(predict(fit), dN.dS)
plot(1:10, 1-1/(1:10))
plot(1:10, 1:10^2
)
plot(1:10, (1:10)^2)
plot(predict(fit), dN.dS)
plot(predict(fit)^2, dN.dS)
cor(predict(fit)^2, dN.dS)
cor(predict(fit), dN.dS)
cor(predict(fit), dN.dS)^2
cor(predict(fit)^2, dN.dS)^2
plot(predict(fit), dN.dS)
source('~/Google Drive/Documents/PostDoc/HIVStructuralDeterminants/hiv_structural_determinants/data/protease/protease_structure/predictors/calc_correlations.R')
plot(predict(fit), dN.dS)
plot(predict(fit), log(dN.dS))
plot(predict(fit), dN.dS)
plot(predict(fit)[dN.dS < 3], dN.dS[dN.dS < 3])
plot(predict(fit)[dN.dS < 3], dN.dS[dN.dS < 3]^2)
plot(predict(fit)[dN.dS < 3], dN.dS[dN.dS < 3])
plot(predict(fit)[dN.dS < 3], dN.dS[dN.dS < 3]^2)
cor(predict(fit)[dN.dS < 3], dN.dS[dN.dS < 3]^2)
cor(predict(fit)[dN.dS < 3], dN.dS[dN.dS < 3])
plot(predict(fit)[dN.dS < 3], dN.dS[dN.dS < 3])
plot(rsa, dN.dS[dN.dS < 3])
plot(rsa, dN.dS)
plot(rsa[dN.dS<3], dN.dS[dN.dS <3])
cor(rsa[dN.dS<3], dN.dS[dN.dS <3])
cor(rsa, dN.dS)
source('~/Google Drive/Documents/PostDoc/HIVStructuralDeterminants/hiv_structural_determinants/data/protease/protease_structure/predictors/calc_correlations.R')
source('~/Google Drive/Documents/PostDoc/HIVStructuralDeterminants/hiv_structural_determinants/data/protease/protease_structure/predictors/calc_correlations.R')
source('~/Google Drive/Documents/PostDoc/HIVStructuralDeterminants/hiv_structural_determinants/data/protease/protease_structure/predictors/calc_correlations.R')
source('~/Google Drive/Documents/PostDoc/HIVStructuralDeterminants/hiv_structural_determinants/data/protease/protease_structure/predictors/calc_correlations.R')
source('~/Google Drive/Documents/PostDoc/HIVStructuralDeterminants/hiv_structural_determinants/data/protease/protease_structure/predictors/calc_correlations.R')
source('~/Google Drive/Documents/PostDoc/HIVStructuralDeterminants/hiv_structural_determinants/data/protease/protease_structure/predictors/calc_correlations.R')
source('~/Google Drive/Documents/PostDoc/HIVStructuralDeterminants/hiv_structural_determinants/data/protease/protease_structure/predictors/calc_correlations.R')
source('~/Google Drive/Documents/PostDoc/HIVStructuralDeterminants/hiv_structural_determinants/data/protease/protease_structure/predictors/calc_correlations.R')
